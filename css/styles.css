:root {
  --bg:#fff; --fg:#111827; --muted:#6b7280;
  --brand:#27ae60; --brand2:#2ecc71;
  --card:#f8fafc; --border:#e5e7eb;
  --danger:#dc2626; --ok:#0b5394; --accent:#ffb703;
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font: 16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial;
  color: var(--fg);
  background: var(--bg);
  padding-bottom: env(safe-area-inset-bottom);
}

/* A11y */
.visually-hidden { position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
.skip { position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }
.skip:focus { left: 10px; top: 10px; width:auto; height:auto; padding:.5rem .75rem; background:#000; color:#fff; z-index:9999; }

header {
  position: sticky; top: 0; z-index:1000;
  background: linear-gradient(180deg, rgba(39,174,96,0.10), rgba(39,174,96,0));
  border-bottom: 1px solid var(--border);
  padding: .75rem .75rem .5rem .75rem;
}

.header-row { display:flex; align-items:center; gap:.5rem; }
header h1 { margin:.25rem 0 0 0; font-size:1.25rem; }
header p { margin:.125rem 0 0 0; color:var(--muted); font-size:.9rem; }
.header-actions { margin-left:auto; display:flex; gap:.5rem; align-items:center; }
header .brand { display:flex; flex-direction:column; margin: 0 .25rem; }
header .flag { font-size: 20px; filter: saturate(.95); }

.lang-switch { display:inline-flex; gap:.25rem; border:1px solid var(--border); border-radius:.6rem; padding:.125rem; background:#fff; }
.lang-switch .lang { background:#fff; color:var(--fg); border:0; padding:.35rem .5rem; border-radius:.45rem; }
.lang-switch .lang.active { background: var(--brand); color:#fff; }

.toolbar {
  display:grid; grid-template-columns: 1fr 220px auto auto auto auto auto; gap:.5rem; margin-top:.5rem;
}
@media (max-width: 920px){
  .toolbar { grid-template-columns: 1fr 1fr 1fr 1fr; }
  .toolbar .full { grid-column: 1 / -1; }
}

input[type="search"], select, button, .btn {
  font: inherit; padding:.6rem .7rem; border:1px solid var(--border); border-radius:.6rem; background:#fff;
}
button { background: var(--brand); color:#fff; border: none; cursor: pointer; }
button.secondary { background:#fff; color:var(--fg); border:1px solid var(--border); }
button:focus, .chip:focus { outline: 3px solid rgba(39,174,96,.35); outline-offset: 2px; }

.tabs { display:flex; gap:.25rem; margin:.5rem 0 0; }
.tabs button { background:transparent; color:var(--fg); border:1px solid var(--border); }
.tabs button[aria-selected="true"] { background: var(--brand); color:#fff; border-color: var(--brand); }

main { display:grid; grid-template-columns: 460px 1fr; min-height: calc(100dvh - 140px); }
@media (max-width: 1000px){ main { grid-template-columns: 1fr; } }

.panel { padding:.75rem; }
#panel-map { padding:0; }
#map { width:100%; height: calc(100dvh - 220px); }

.panel-actions { margin-top:.75rem; display:flex; gap:.5rem; flex-wrap:wrap; }

ul#spots { list-style:none; padding:0; margin:0; display:flex; flex-direction: column; gap:.5rem; }

.spot-card { background: var(--card); border:1px solid var(--border); border-radius:.8rem; padding:.75rem; }
.spot-card .spot-head { display:flex; align-items:center; justify-content:space-between; gap:.5rem; }
.spot-card h3 { margin:.25rem 0; font-size:1.05rem; }
.spot-card .meta { display:flex; gap:.4rem; flex-wrap:wrap; }
.spot-card .poetry { color: var(--muted); margin: .25rem 0 .4rem 0; }
.spot-card .addr { margin:0 0 .5rem 0; }
.spot-card .fav { font-size:1.1rem; padding:.3rem .6rem; border-radius:.6rem; border:1px solid var(--border); background:#fff; color: var(--fg); }
.spot-card .row { display:flex; gap:.5rem; align-items:center; flex-wrap:wrap; }

.badge { display:inline-block; padding:.2rem .5rem; border-radius:.5rem; font-size:.75rem; }
.badge.cat { background: #eef7f1; color:#14532d; border:1px solid #d7f0e0; }
.badge.ok { background: #e6f6ff; color:#0b5394; border:1px solid #bfe7ff; }
.badge.score { background:#fff7ed; color:#9a3412; border:1px solid #fde5c8; }

.chip { display:inline-block; padding:.25rem .5rem; border-radius:999px; border:1px solid var(--border); background:#fff; margin:.125rem; font-size:.85rem; }
.muted { color: var(--muted); }
.small { font-size:.85rem; }

/* Leaflet emoji pin */
.spot-emoji { transform: translate(-12px, -12px); font-size: 22px; }
.spot-emoji span { text-shadow: 0 1px 2px rgba(0,0,0,.25); }

/* Offline banner */
#offline {
  position: fixed; bottom:10px; right:10px;
  background: #111827; color:#fff; padding:.5rem .75rem; border-radius:.6rem;
  font-size:.85rem; opacity:0; pointer-events:none; transition:opacity .2s;
}
#offline.show { opacity:1; pointer-events:auto; }

/* Modal */
.overlay { position:fixed; inset:0; background: rgba(0,0,0,.4); display:grid; place-items:center; }
.modal { background:#fff; border-radius:.8rem; border:1px solid var(--border); max-width:860px; width:min(96vw, 860px); padding:1rem; }
.modal h2 { margin-top:0; }
.modal .grid { display:grid; grid-template-columns: repeat(2, 1fr); gap:.5rem; }
.modal .grid label { display:flex; flex-direction:column; gap:.25rem; font-size:.95rem; }
.modal input, .modal select { padding:.5rem .6rem; border:1px solid var(--border); border-radius:.6rem; }
.modal-actions { display:flex; justify-content:flex-end; gap:.5rem; margin-top:.5rem; }
.json-output pre { background:#0b1b2b; color:#e6f4ff; padding:.75rem; border-radius:.6rem; overflow:auto; max-height:40vh; }
.json-actions { display:flex; gap:.5rem; margin:.5rem 0; }

footer { padding: 2rem .75rem; color: var(--muted); border-top:1px solid var(--border); }
footer a { color: var(--brand); text-decoration: none; }

/* Offline page */
.offline-page .center { min-height: 90vh; display:grid; place-items:center; text-align:center; }
.btn { display:inline-block; padding:.6rem .8rem; border:1px solid var(--border); border-radius:.6rem; background:#fff; color:var(--fg); }